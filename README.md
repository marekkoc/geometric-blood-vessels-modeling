<div align="right">
  <img src="figs/bergen_head_big.gif" width="200">
</div>
# Geometric modeling of blood vessels

## Introduction

Cardiovascular diseases are the leading cause of death worldwide. Their prevention and treatment require accurate, noninvasive and personalized diagnostic techniques. At present, the leading technique is magnetic resonance (MR) tomography. It allows acquisition of three-dimensional images of blood filling the vessels and tissues, without use of contrast agents or X-ray radiation. Despite huge, still unexplored capabilities of this method, images accessible in clinics consist of elementary cuboids (voxels) of finite dimensions, e. g. 0,5x0,5x0,5 mm^3^. The intensity of each voxel is constant within its space, e. g. proportional to the amount of blood filling it. On the other hand, the diameter of the blood vessel branches takes values from a few centimeters for aorta (macroscopic scale) down to tens of micrometers for venules and arterioles (mesoscopic scale). The radius of most arteries and veins is comparable then to the length of voxel sides. This leads to the effect of voxelization – vessel regions are approximated by sets of cuboids (boxes). Smooth boundaries between the vessel and surrounding tissues take unnatural form of staircase surfaces. There is a need for development of algorithms for reconstruction of the original shape and dimensions of blood vessels for medical diagnosis, through numerical analysis of their severely distorted (due to the limited resolution) images. Moreover, the MR images feature random intensity fluctuations which are an additional source of uncertainty in finding the course of centerlines and measuring the diameter of vessels. The modeling algorithms should be robust to those (and other) distortions and noise, inherent to MR tomography. Comprehensive modelling of the processes of blood delivery to tissues has to account for the fact thin branches, of diameter smaller than the voxel side, are not visible in the image as separate regions, one can observe the net effect of their perfusion with blood only.

The project is aimed at development of mathematical description of the structure of blood vessels visualized in 3D magnetic resonance images. Such models offer objective, accurate geometrical information on the blood vessel trees and parameters of their branches – for detailed, personalized diagnosis of the circulatory system. They can be used for noninvasive simulation of blood flow, e. g. in critical regions such as stenoses and aneurysms. Geometric modeling allows for construction of vascular prostheses, e. g. via 3D printing, to restore patency of diseased branches.

## Methods
In the traditional approach to blood vessels modeling image segmentation is first applied, e. g. through intensity thresholding, to produce a binary image defined in points of voxels diagonals intersection – too sparse to represent the vessel walls location in the space between those points. Such segmentation does not account for information on local shape of the walls, on the course of centerlines and on intensity profiles in the space around the points of the digital image. Therefore, in this project, the segmentation was not applied to the image. Instead, continuous (analog) models representing key phenomena of the process of MR image formation were used. Parametric models of those phenomena were defined. By local tuning of the parameters, the models were fitted to image intensity spatial distribution. In this way, quantitative evaluation of significant geometric properties of blood vessels were obtained, in the analog space.

The algorithm developed for geometric modeling of blood vessel trees is illustrated in Fig. 1 (Materka 2015). The image of the tree is filtered using a multiscale Frangi “vesselness” filter, based on computation of Hessian at each point. The filter enhances elongated blood vessel objects and suppresses the background intensity. The result of filtering is thresholded, and then binary regions skeleton is found. In our method, segments between the tree bifurcations are approximated by a smooth (differentiable) function of 3 spatial coordinates. This allows computation of tangent vectors to the centerline and planes perpendicular to them – local cross-sections. In this way, azimuth and elevation angles are insensitive to random fluctuations and intensity jumps taking place in ToF images.

On the cross-section planes, an intensity profile model is fitted to take account of vessel edge blurring originating in MR signal averaging inside the voxel space and other effects, jointly representing the MR scanner “impulse response” or “point spread function”. The intensity profile along radial directions around the vessel centerline point (Fig. 2a) is continuous and given analytically (Materka 1991), (Materka 2015). The results of model fitting are local values of background intensity, intensity jump inside the vessel and the vessel radius.

Vessel segments between bifurcations are described by sets of centerline points, each attributed a tangent vector and radius, Fig. 3a. This description allows easy approximation of the surface of the vessel walls by a triangular mesh, Fig. 3b. By applying these steps to all the vascular tree segments of the skeleton, one obtains the whole geometric model of the macroscopic part of the artery (ToF) and vein (QSM) trees visualized in the images, Fig. 3c.

The reconstructed segments of the vessel tree are coupled together via dedicated T-junctions to model the bifurcations, Fig. 3d, developed with the use of computer graphics techniques (Kociński 2016), Vinhais 2018). The assumption of circular vessel branch shape can be easily relaxed to move the nodes of the triangular mesh to the actual vessel tree surface, with a small number of iterative refinements (Vinhais 2018).
